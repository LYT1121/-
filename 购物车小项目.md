# 购物车

大致了解一下，电商网站是怎么样展示商品数据

首先我们的浏览器会发送请求到服务器，把一个数组获取回来，交给前端工作人员，前端工作人员就会使用代码，动态创建元素，给用户展示数据



但是现在我们还不会写服务器的代码，也没有服务器，暂时自己模拟一个假的数据

我们需要练习这种模拟假数据的能力

将来工作中，如果遇上服务器开发人员还不能给你数据的情况，就需要自己先根据需求，自己模拟一些假数据，让自己的代码可以先写，如果把后续的开发代码都写好了，将来只需要把假数据切换为真数据即可

需要根据需求分析，功能需要哪些数据

开始分析：

每个商品的数据可能包括哪些？

```js
价格、图片、商品名称、已经销售了多少、库存、id(唯一性的根本依据)
```

使用什么方式来存储这些数据？

数组 - 一次性会得到多个商品数据，多个数据，最好的方式就是存储为数组

每个商品有多个信息要存储 - 对象，以对象的形式存储多个数据，即统一又方便管理

```js
[
  {
    价格,图片,商品名称,id,库存，销量
  }  
]
```



## 现在列表页展示所有的商品的数据

使用一个data.js模拟这是从服务器传递回来的数据

把数组里面的每个对象，以一个商品的形式展示给用户看

遍历数组，动态的生成一个结构，把结构放到商品列表页里面



实现过程：

1.先新建一个list.js，在里面写代码

2.引入data.js

2.在list.html里面引入jq

```html
<body>
  
</body>
<script src="jq的路径"></script>
例如
<script src="./js/jquery.js"></script>
```

3.引入list.js

4.在list.js里面开始写逻辑代码



## 点击商品，可以跳转查看

我们需要把对应商品的id，带到详情页面

不同的页面之间要传递数据，可以采用的一个方式： 浏览器的地址栏携带数据

格式：

```
页面地址?键1=值1&键2=值2
```



希望在跳转的时候，能够把商品的id带上，就需要在a标签的后面加上一个固定格式

```
？键=值&键=值&键=值
```

需要在生成页面结构的地方动手脚

```js
html += `<li class="goods-list-item">
    <a href="detail.html?id=${e.pID}">
      <div class="item-img">`...
```



此时就可以获取到浏览器地址栏里面的id

以前学过，浏览器的地址栏归 location对象管

location.search 这个属性管理着浏览器地址栏?后面的所有的内容

就可以可以通过该属性得到id

```
location.search
```

location.search 是一个字符串，如果想要得到里面的某个字符串，可以采用截取字符串的方式

```js
字符串.substring(从哪里开始截取，总共截取多少个)
```

所以可以直接截取

```js
location.search.substring(4) // 获取了id
```



如果得到了id，我们就可以根据这个id，到数组里面，取出对应的数据，把数据再展示到detail页面里面即可

想要数据，就得下引入数组的js，又需要引入data.js

遍历数组，从里面筛选出一个满足条件的对象，然后根据对象把对应的信息替换掉

自己遍历太麻烦了，使用了数组的一个新的方法 `find` 方法，这个方法的使用

用法

```js
数组.find(function(e,i){
  要返回一个条件
})
例如我们的今天的需求
phoneData.find((e,i)=>{
  return e.pID == id;// id是我们之前根据浏览器的地址栏获取的
})
```

该方法的返回值是一个满足条件的元素

然后我们就拿到了id对应的对象，可以把对象里面的数据，替换掉页面上的文字

换产品名称

```js
$('.sku-name').text(obj.name);
```



换价格

```js
$('.summary-price em').text('￥'+obj.price);
```



换图片

```js
$('.preview-img>img').attr('src',obj.imgSrc);
```



## 在详情页处理加减数量的问题

我们点击+号，让件数增加，点击-号，让件数减少

1.获取元素

```js
let chooseNumber = $('.choose-number');
let addBtn = $('.add');
let reduceBtn = $('.reduce');
```

2.给加号按钮注册点击事件

3.我们要让数字不断的向上+1，就需要获取原来的值，但是原来的值获取到之后，是一个字符串，需要使用parseInt先转换为整数，再+1，之后设置回原来value里面即可。减号按钮一开始有一个不可操作的样式的，需要我们在点击+的时候，如果当前的件数已将是大于1，就把减号的禁用样式去除，就是移除了一个class

```js
let old = parseInt(chooseNumber.val());
old++;
//如果点击+号，当前的数量大于1，就让-号可以被点击
if(old > 1){
  reduceBtn.removeClass('disabled');
}
// 把新的数据设置回输入框
chooseNumber.val(old);
```

4.给减号按钮注册点击事件

5.如果当前的件数已经是1 了，就不能继续点击了，如果点击过后，值变为1，也不能让用户继续点了，就把禁用的样式加回来

```js
let old = parseInt(chooseNumber.val());
if(old === 1){ // 如果当前是1，就不能继续点击减少      
  return;
}
old--;
if(old === 1){
  reduceBtn.addClass('disabled');
}
// 把新的数据设置回输入框
chooseNumber.val(old);
```





